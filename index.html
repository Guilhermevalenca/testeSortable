<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- importando a biblioteca do Sortable -->
  <script src="script/sortable.js"></script>
    <title>Document</title>
    <style>
        #origem{
            border-style: solid;
            display: grid;
        }
        .destino{
            border-style: solid;
            display: flex;
            width: 8em;
            height: 2em;
        }
        
    </style>
</head>
<body>
    <div id="origem">
        <label>
            Portugues
            <input type="hidden" name="materia[]" value="Portugues">
            <input type="hidden" name="linha[]">
            <input type="hidden" name="coluna[]">
        </label>
        <label>
            Matematica
            <input type="hidden" name="materia[]" value="Matematica">
            <input type="hidden" name="linha[]">
            <input type="hidden" name="coluna[]">
        </label>
        <label>
            Fisica
            <input type="hidden" name="materia[]" value="Fisica">
            <input type="hidden" name="linha[]">
            <input type="hidden" name="coluna[]">
        </label>
    </div>
    <br>
    <form action="imprimir.php" method="GET">
    <table>
        <thead>
            <tr>
              <th></th>
              <th>Domingo</th>
              <th>Segunda</th>
              <th>Ter√ßa</th>
              <th>Quarta</th>
              <th>Quinta</th>
              <th>Sexta</th>
              <th>Sabado</th>
            </tr>
          </thead>
        <tbody>
            <tr class="aqui">
                <th>08:00</th>
                <td><div class="destino"></div></td>
                <td><div class="destino"></div></td>
                <td><div class="destino"></div></td>
                <td><div class="destino"></div></td>
                <td><div class="destino"></div></td>
                <td><div class="destino"></div></td>
                <td><div class="destino"></div></td>
            </tr>
            <tr class="aqui">
                <td>09:00</td>
                <td><div class="destino"></div></td>
                <td><div class="destino"></div></td>
                <td><div class="destino"></div></td>
                <td><div class="destino"></div></td>
                <td><div class="destino"></div></td>
                <td><div class="destino"></div></td>
                <td><div class="destino"></div></td>
            </tr>
            <tr class="aqui">
                <td>10:00</td>
                <td><div class="destino"></div></td>
                <td><div class="destino"></div></td>
                <td><div class="destino"></div></td>
                <td><div class="destino"></div></td>
                <td><div class="destino"></div></td>
                <td><div class="destino"></div></td>
                <td><div class="destino"></div></td>
            </tr>
        </tbody>
    </table>
    <button>envia</button>
    </form>
<script>
origem = document.getElementById('origem');
destino = document.querySelectorAll('.destino');
linha = document.querySelectorAll('input[name="linha[]"]');
coluna = document.querySelectorAll('input[name="coluna[]"]');
aqui = document.querySelectorAll('.aqui');
 
new Sortable(origem, {
    group: 'shared',
    animation: 150
})
//teste horrivel:
/*
for(let i = 0; i < destino.length; i++){
     
    new Sortable(destino[i], {
        group: 'shared',
        animation: 150
    })  
    destino[i].addEventListener('drop', (event) => {
        event.preventDefault();
         
        event.target.appendChild(destino[i]);
        const tableLinha = event.target.parentNode.cellIndex - 1;
        linha[i].value = tableLinha;
         
        const tableColuna = (event.target.parentNode.parentNode).rowIndex - 1;
        coluna[i].value = tableColuna;
         
    })
};
*/
//teste nao sei quem ta pior:

destino.forEach(element => {
     
    new Sortable(element, {
        group: 'shared',
        animation: 150
    })
     
    element.addEventListener('drop', (event) => {
        //event.preventDefault();
        //aqui deveria ser salva a linha e coluna que foi colocado um dos label de origem
        const td = event.target.closest('td');
        const row = td.parentNode.rowIndex;
        const column = td.cellIndex;
         
        linha.forEach((input) => {
            if (input.parentNode === event.item) {
                input.value = row;
            }
        });
         
        coluna.forEach((input) => {
            if (input.parentNode === event.item) {
                input.value = column;
            }
        });    
    })
});
</script>
</body>
</html>