<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- importando a biblioteca do Sortable -->
  <script src="script/sortable.js"></script>
    <title>Document</title>
    <style>
        #origem{
            border-style: solid;
        }
        .destino{
            border-style: solid;
            width: 8em;
            height: 2em;
        }
        
    </style>
</head>
<body>
    <div id="origem">
        <label>
            Portugues
            <input type="hidden" name="materia[]" value="Portugues">
            <input class="linha" type="hidden" name="linha[]">
            <input class="coluna" type="hidden" name="coluna[]">
        </label>
        <label>
            Matematica
            <input type="hidden" name="materia[]" value="Matematica">
            <input class="linha" type="hidden" name="linha[]">
            <input class="coluna" type="hidden" name="coluna[]">
        </label>
        <label>
            Fisica
            <input type="hidden" name="materia[]" value="Fisica">
            <input class="linha" type="hidden" name="linha[]">
            <input class="coluna" type="hidden" name="coluna[]">
        </label>
    </div>
    <br>
    <form id="form" action="imprimir.php" method="POST">
    <table>
        <thead>
            <tr>
              <th></th>
              <th>Domingo</th>
              <th>Segunda</th>
              <th>Ter√ßa</th>
              <th>Quarta</th>
              <th>Quinta</th>
              <th>Sexta</th>
              <th>Sabado</th>
            </tr>
          </thead>
        <tbody>
            <tr>
                <th>08:00</th>
                <td class="destino"></td>
                <td class="destino"></td>
                <td class="destino"></td>
                <td class="destino"></td>
                <td class="destino"></td>
                <td class="destino"></td>
                <td class="destino"></td>
            </tr>
            <tr>
                <td>09:00</td>
                <td class="destino"></td>
                <td class="destino"></td>
                <td class="destino"></td>
                <td class="destino"></td>
                <td class="destino"></td>
                <td class="destino"></td>
                <td class="destino"></td>
            </tr>
            <tr>
                <td>10:00</td>
                <td class="destino"></td>
                <td class="destino"></td>
                <td class="destino"></td>
                <td class="destino"></td>
                <td class="destino"></td>
                <td class="destino"></td>
                <td class="destino"></td>
            </tr>
        </tbody>
    </table>
    <button>envia</button>
    </form>
<script>
const origem = document.getElementById('origem');
const destino = document.querySelectorAll('.destino');
const linha = document.querySelectorAll('.linha');
const coluna = document.querySelectorAll('.coluna');
const form = document.querySelector('#form');
 
new Sortable(origem, {
    group: 'shared',
    animation: 150
})
//teste horrivel:
/*
for(let i = 0; i < destino.length; i++){
     
    new Sortable(destino[i], {
        group: 'shared',
        animation: 150
    })  
    destino[i].addEventListener('drop', (event) => {
        event.preventDefault();
         
        event.target.appendChild(destino[i]);
        const tableLinha = event.target.parentNode.cellIndex - 1;
        linha[i].value = tableLinha;
         
        const tableColuna = (event.target.parentNode.parentNode).rowIndex - 1;
        coluna[i].value = tableColuna;
         
    })
};
*/
//teste nao sei quem ta pior:

destino.forEach(element => {
     
    new Sortable(element, {
        group: 'shared',
        animation: 150
    })
});
form.addEventListener('submit', (event) => {
    event.preventDefault();
    let cont = 0;
    //aqui deveria ser salva a linha e coluna que foi colocado um dos label de origem
    
    const td = event.target.closest('td');
    const row = td.parentNode.rowIndex;
    const column = td.cellIndex;
    
    linha.forEach((input) => {
        if (input.parentNode === event.item) {
            input.value = row;
            cont++;
        }
    });
    
    coluna.forEach((input) => {
        if (input.parentNode === event.item) {
            input.value = column;
            cont++;
        }
    });
    console.log(cont);
})
</script>
</body>
</html>